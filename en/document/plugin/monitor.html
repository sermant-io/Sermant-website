<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Monitoring | Sermant</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/logo.svg">
    <meta name="description" content="A Proxyless Service Mesh based on Bytecode Enhancement">
    
    <link rel="preload" href="/assets/css/0.styles.aea4a1e9.css" as="style"><link rel="preload" href="/assets/js/app.e0934d96.js" as="script"><link rel="preload" href="/assets/js/3.06f127bc.js" as="script"><link rel="preload" href="/assets/js/1.c8bacf5b.js" as="script"><link rel="preload" href="/assets/js/53.9cfa5608.js" as="script"><link rel="preload" href="/assets/js/14.199c38f6.js" as="script"><link rel="prefetch" href="/assets/js/10.11126491.js"><link rel="prefetch" href="/assets/js/100.bb629ae2.js"><link rel="prefetch" href="/assets/js/101.1c471839.js"><link rel="prefetch" href="/assets/js/102.8b093da5.js"><link rel="prefetch" href="/assets/js/103.0c246fd4.js"><link rel="prefetch" href="/assets/js/104.53bd9de7.js"><link rel="prefetch" href="/assets/js/105.3812faf4.js"><link rel="prefetch" href="/assets/js/106.164f80b3.js"><link rel="prefetch" href="/assets/js/107.db1700ed.js"><link rel="prefetch" href="/assets/js/108.939781bd.js"><link rel="prefetch" href="/assets/js/109.d0427332.js"><link rel="prefetch" href="/assets/js/11.592204d9.js"><link rel="prefetch" href="/assets/js/110.32bda31e.js"><link rel="prefetch" href="/assets/js/111.edd529db.js"><link rel="prefetch" href="/assets/js/112.63653900.js"><link rel="prefetch" href="/assets/js/113.a357ff5e.js"><link rel="prefetch" href="/assets/js/114.686320db.js"><link rel="prefetch" href="/assets/js/115.6145b589.js"><link rel="prefetch" href="/assets/js/12.fd6a031f.js"><link rel="prefetch" href="/assets/js/13.7427e98b.js"><link rel="prefetch" href="/assets/js/15.900a8374.js"><link rel="prefetch" href="/assets/js/16.adaf3c84.js"><link rel="prefetch" href="/assets/js/17.56443d55.js"><link rel="prefetch" href="/assets/js/18.0cb1c621.js"><link rel="prefetch" href="/assets/js/19.f3f80c20.js"><link rel="prefetch" href="/assets/js/20.ad890ca8.js"><link rel="prefetch" href="/assets/js/21.75729028.js"><link rel="prefetch" href="/assets/js/22.43cc7ae1.js"><link rel="prefetch" href="/assets/js/23.80aecc10.js"><link rel="prefetch" href="/assets/js/24.d862bfe2.js"><link rel="prefetch" href="/assets/js/25.698376aa.js"><link rel="prefetch" href="/assets/js/26.a6ac8be9.js"><link rel="prefetch" href="/assets/js/27.09e84572.js"><link rel="prefetch" href="/assets/js/28.2400a5c0.js"><link rel="prefetch" href="/assets/js/29.54bad9a2.js"><link rel="prefetch" href="/assets/js/30.bed90676.js"><link rel="prefetch" href="/assets/js/31.5a0cda15.js"><link rel="prefetch" href="/assets/js/32.fae9f060.js"><link rel="prefetch" href="/assets/js/33.d9926dae.js"><link rel="prefetch" href="/assets/js/34.d8960a15.js"><link rel="prefetch" href="/assets/js/35.82a71bbb.js"><link rel="prefetch" href="/assets/js/36.be57ebe6.js"><link rel="prefetch" href="/assets/js/37.f1740a13.js"><link rel="prefetch" href="/assets/js/38.e617442c.js"><link rel="prefetch" href="/assets/js/39.13bbacce.js"><link rel="prefetch" href="/assets/js/4.7add7152.js"><link rel="prefetch" href="/assets/js/40.dedffce9.js"><link rel="prefetch" href="/assets/js/41.ee37f503.js"><link rel="prefetch" href="/assets/js/42.c6aa5076.js"><link rel="prefetch" href="/assets/js/43.d8850573.js"><link rel="prefetch" href="/assets/js/44.ef4e02ab.js"><link rel="prefetch" href="/assets/js/45.cb46aba8.js"><link rel="prefetch" href="/assets/js/46.5362eeb2.js"><link rel="prefetch" href="/assets/js/47.706a7dbb.js"><link rel="prefetch" href="/assets/js/48.098a121c.js"><link rel="prefetch" href="/assets/js/49.0d4508d4.js"><link rel="prefetch" href="/assets/js/5.4a333fb7.js"><link rel="prefetch" href="/assets/js/50.0a891537.js"><link rel="prefetch" href="/assets/js/51.623b7394.js"><link rel="prefetch" href="/assets/js/52.a94dbeda.js"><link rel="prefetch" href="/assets/js/54.910bbc3e.js"><link rel="prefetch" href="/assets/js/55.ef62bf5d.js"><link rel="prefetch" href="/assets/js/56.a2f0ad08.js"><link rel="prefetch" href="/assets/js/57.a0e4792b.js"><link rel="prefetch" href="/assets/js/58.3b83140b.js"><link rel="prefetch" href="/assets/js/59.255861a7.js"><link rel="prefetch" href="/assets/js/6.72029eac.js"><link rel="prefetch" href="/assets/js/60.f1229caf.js"><link rel="prefetch" href="/assets/js/61.c00aff9b.js"><link rel="prefetch" href="/assets/js/62.4125fce4.js"><link rel="prefetch" href="/assets/js/63.2f37913f.js"><link rel="prefetch" href="/assets/js/64.e645ee4e.js"><link rel="prefetch" href="/assets/js/65.e0aa064f.js"><link rel="prefetch" href="/assets/js/66.929b4eb4.js"><link rel="prefetch" href="/assets/js/67.349bf041.js"><link rel="prefetch" href="/assets/js/68.df035518.js"><link rel="prefetch" href="/assets/js/69.2e143b01.js"><link rel="prefetch" href="/assets/js/7.698dd478.js"><link rel="prefetch" href="/assets/js/70.c311703c.js"><link rel="prefetch" href="/assets/js/71.227a9f68.js"><link rel="prefetch" href="/assets/js/72.050abee1.js"><link rel="prefetch" href="/assets/js/73.288cdc6f.js"><link rel="prefetch" href="/assets/js/74.cc2dec6d.js"><link rel="prefetch" href="/assets/js/75.83cc918a.js"><link rel="prefetch" href="/assets/js/76.fcbe5122.js"><link rel="prefetch" href="/assets/js/77.3bafe1cd.js"><link rel="prefetch" href="/assets/js/78.61a9dc3a.js"><link rel="prefetch" href="/assets/js/79.9e1e5534.js"><link rel="prefetch" href="/assets/js/8.10750ce9.js"><link rel="prefetch" href="/assets/js/80.a56d59b3.js"><link rel="prefetch" href="/assets/js/81.d4686ffc.js"><link rel="prefetch" href="/assets/js/82.74ebb177.js"><link rel="prefetch" href="/assets/js/83.152705b1.js"><link rel="prefetch" href="/assets/js/84.fa6503cf.js"><link rel="prefetch" href="/assets/js/85.091d014e.js"><link rel="prefetch" href="/assets/js/86.952b21e3.js"><link rel="prefetch" href="/assets/js/87.b2fa207d.js"><link rel="prefetch" href="/assets/js/88.b69f94cf.js"><link rel="prefetch" href="/assets/js/89.62f36c6b.js"><link rel="prefetch" href="/assets/js/9.7f57e4b0.js"><link rel="prefetch" href="/assets/js/90.f66c7cc6.js"><link rel="prefetch" href="/assets/js/91.8a2f00b2.js"><link rel="prefetch" href="/assets/js/92.48caadca.js"><link rel="prefetch" href="/assets/js/93.c11d98ef.js"><link rel="prefetch" href="/assets/js/94.b07e62c5.js"><link rel="prefetch" href="/assets/js/95.b21bea24.js"><link rel="prefetch" href="/assets/js/96.7a2c2952.js"><link rel="prefetch" href="/assets/js/97.6b7862c9.js"><link rel="prefetch" href="/assets/js/98.70817e89.js"><link rel="prefetch" href="/assets/js/99.f54535d0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aea4a1e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/img/sermant-logo.png" alt="Sermant" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/plugin/monitor.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/plugin/monitor.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/document/" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://github.com/sermant-io/Sermant" target="_blank" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/document/plugin/monitor.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/en/document/plugin/monitor.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <div class="nav-item"><!----></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>User Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Plugin Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/document/plugin/" aria-current="page" class="sidebar-link">Plugin</a></li><li><a href="/en/document/plugin/dynamic-config.html" class="sidebar-link">Dynamic Configuration</a></li><li><a href="/en/document/plugin/springboot-registry.html" class="sidebar-link">SpringBoot Registry</a></li><li><a href="/en/document/plugin/register-migration.html" class="sidebar-link">Service Registry</a></li><li><a href="/en/document/plugin/flowcontrol.html" class="sidebar-link">Flow Control</a></li><li><a href="/en/document/plugin/graceful.html" class="sidebar-link">Graceful Startup/Shutdown</a></li><li><a href="/en/document/plugin/removal.html" class="sidebar-link">Outlier instance removal</a></li><li><a href="/en/document/plugin/loadbalancer.html" class="sidebar-link">Load balancing</a></li><li><a href="/en/document/plugin/router.html" class="sidebar-link">Tag Router</a></li><li><a href="/en/document/plugin/monitor.html" aria-current="page" class="active sidebar-link">Monitoring</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/document/plugin/monitor.html#function-introduction" class="sidebar-link">Function introduction</a></li><li class="sidebar-sub-header"><a href="/en/document/plugin/monitor.html#parameter-configuration" class="sidebar-link">Parameter configuration</a></li><li class="sidebar-sub-header"><a href="/en/document/plugin/monitor.html#detailed-governance-rules" class="sidebar-link">Detailed governance rules</a></li><li class="sidebar-sub-header"><a href="/en/document/plugin/monitor.html#supported-versions-and-restrictions" class="sidebar-link">Supported versions and restrictions</a></li><li class="sidebar-sub-header"><a href="/en/document/plugin/monitor.html#operation-and-result-verification" class="sidebar-link">Operation and result verification</a></li></ul></li><li><a href="/en/document/plugin/visibility.html" class="sidebar-link">Service visibility</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Developer Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Community Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FAQ</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="monitoring"><a href="#monitoring" class="header-anchor">#</a> Monitoring</h1> <p>This article describes how to use the <a href="https://github.com/sermant-io/Sermant/tree/develop/sermant-plugins/sermant-monitor" target="_blank" rel="noopener noreferrer">Monitoring plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="function-introduction"><a href="#function-introduction" class="header-anchor">#</a> Function introduction</h2> <p>The monitoring plug-in is used to monitor the usage of CPU, memory, disk IO, network IO and other hardware resources of the server where the host application is located. The usage of JVM resources, such as heap memory usage, non-heap memory usage, cache usage, throughput (QPS, TPS, average response time). The monitoring plug-in relies on Prometheus for indicator collection. Prometheus will periodically pull the indicator data collected by the monitoring plugin.</p> <h2 id="parameter-configuration"><a href="#parameter-configuration" class="header-anchor">#</a> Parameter configuration</h2> <h3 id="plugin-configuration"><a href="#plugin-configuration" class="header-anchor">#</a> Plugin configuration</h3> <p>The monitoring plugin needs to be configured with monitoring enable switch (<code>monitor.config.enableStartService</code>), IP address/domain name of the host application's environment (<code>monitor.config.address</code>), the port of the host service (<code>monitor.config.port</code>) and the reporting method (<code>monitor.config.reportType</code>). The configuration file of the plug-in can be found in the <code>${path}/sermant-agent-x.x.x/agent/pluginPackage/monitor/config/config.yaml</code>. The configuration is as follows:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">monitor.config</span><span class="token punctuation">:</span>                     <span class="token comment"># Monitoring plug-in configuration.</span>
    <span class="token key atrule">enableStartService</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>       <span class="token comment"># Monitoring plug-in start switch. When it is true, the indicator is collected.</span>
    <span class="token key atrule">address</span><span class="token punctuation">:</span> 127.0.0.1              <span class="token comment"># IP address/domain name of the host application's environment. Used when creating a server instance. Prometheus obtains the indicator information collected by the plug-in by calling the created server instance.</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">12345</span>                     <span class="token comment"># Provides the port information of Http service externally. Used when creating a server instance. Prometheus obtains the indicator information collected by the plug-in by calling the created server instance.</span>
    <span class="token key atrule">reportType</span><span class="token punctuation">:</span> PROMETHEUS          <span class="token comment"># Monitoring indicator reporting method. Currently only PROMETHEUS is supported.</span>
    <span class="token key atrule">userName</span><span class="token punctuation">:</span>                       <span class="token comment"># Authorization information -- authorization username. After the authorization information is configured, prometheus also needs to configure the authorization information to obtain the indicator normally to prevent malicious requests to obtain the indicator information.</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span>                       <span class="token comment"># Authorization information -- authorized user password -- AES encryption ciphertext. After configuring the authorization information, prometheus also needs to configure the authorization information to obtain the indicator to prevent malicious requests to obtain the indicator information.</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span>                            <span class="token comment"># KEY used for password encryption of authorized users.</span>
</code></pre></div><table><thead><tr><th>Parameter key</th> <th>Description</th> <th>Default value</th> <th>Required</th></tr></thead> <tbody><tr><td>monitor.config.enableStartService</td> <td>Monitoring plugin start switch</td> <td>false</td> <td>Yes</td></tr> <tr><td>monitor.config.address</td> <td>IP address/domain name of the host application's environment</td> <td>127.0.0.1</td> <td>Yes</td></tr> <tr><td>monitor.config.port</td> <td>Port information for external Http service</td> <td>12345</td> <td>Yes</td></tr> <tr><td>monitor.config.reportType</td> <td>Monitoring indicator reporting method currently only supports PROMETHEUS</td> <td>PROMETHEUS</td> <td>Yes</td></tr> <tr><td>monitor.config.userName</td> <td>authorization information -- authorization user name</td> <td>null</td> <td>No</td></tr> <tr><td>monitor.config.password</td> <td>authorization information -- authorized user password -- AES encryption</td> <td>null</td> <td>No</td></tr> <tr><td>monitor.config.key</td> <td>KEY used for password encryption of authorized users</td> <td>Empty</td> <td>No</td></tr></tbody></table> <h2 id="detailed-governance-rules"><a href="#detailed-governance-rules" class="header-anchor">#</a> Detailed governance rules</h2> <p>The indicator data that the monitoring plug-in can collect at present is shown in the following table (after docking with prometheus, users can query the specific indicator information in prometheus through the indicator name, see <a href="#verification">Verification</a>):</p> <h3 id="resource-indicators"><a href="#resource-indicators" class="header-anchor">#</a> Resource indicators</h3> <table><thead><tr><th style="text-align:left;">Indicator name</th> <th style="text-align:left;">Description</th> <th style="text-align:left;">Indicator type</th></tr></thead> <tbody><tr><td style="text-align:left;">cpu_user</td> <td style="text-align:left;">proportion of user time</td> <td style="text-align:left;">CPU</td></tr> <tr><td style="text-align:left;">cpu_sys</td> <td style="text-align:left;">System time share</td> <td style="text-align:left;">CPU</td></tr> <tr><td style="text-align:left;">cpu_wait</td> <td style="text-align:left;">Percentage of waiting time</td> <td style="text-align:left;">CPU</td></tr> <tr><td style="text-align:left;">cpu_idle</td> <td style="text-align:left;">idle time ratio</td> <td style="text-align:left;">CPU</td></tr> <tr><td style="text-align:left;">cpu_cores</td> <td style="text-align:left;">CPU physical cores</td> <td style="text-align:left;">CPU</td></tr> <tr><td style="text-align:left;">memory_total</td> <td style="text-align:left;">Total memory size</td> <td style="text-align:left;">memory</td></tr> <tr><td style="text-align:left;">memory_swap</td> <td style="text-align:left;">Size of swap space for cache memory</td> <td style="text-align:left;">memory</td></tr> <tr><td style="text-align:left;">memory_cached</td> <td style="text-align:left;">Total physical memory of cache memory</td> <td style="text-align:left;">memory</td></tr> <tr><td style="text-align:left;">memory_buffer</td> <td style="text-align:left;">Make a buffer size for the file</td> <td style="text-align:left;">memory</td></tr> <tr><td style="text-align:left;">memory_used</td> <td style="text-align:left;">Used memory size</td> <td style="text-align:left;">memory</td></tr> <tr><td style="text-align:left;">disk_readBytesPerSec</td> <td style="text-align:left;">Number of bytes read by the disk per second during the collection cycle</td> <td style="text-align:left;">Disk IO</td></tr> <tr><td style="text-align:left;">disk_writeBytesPerSec</td> <td style="text-align:left;">Number of bytes written on the disk per second during the collection cycle</td> <td style="text-align:left;">Disk IO</td></tr> <tr><td style="text-align:left;">disk_ioSpentPercentage</td> <td style="text-align:left;">Percentage of time spent on disk IO during the acquisition cycle</td> <td style="text-align:left;">Disk IO</td></tr> <tr><td style="text-align:left;">network_readBytesPerSec</td> <td style="text-align:left;">Number of bytes read by the network per second during the collection cycle</td> <td style="text-align:left;">Network</td></tr> <tr><td style="text-align:left;">network_writeBytesPerSec</td> <td style="text-align:left;">Number of bytes read by the network per second during the collection cycle</td> <td style="text-align:left;">Network</td></tr> <tr><td style="text-align:left;">network_readPackagePerSec</td> <td style="text-align:left;">Number of network bytes per second in the collection cycle</td> <td style="text-align:left;">Network</td></tr> <tr><td style="text-align:left;">network_writePackagePerSec</td> <td style="text-align:left;">Percentage of network IO time spent in the collection cycle</td> <td style="text-align:left;">Network</td></tr> <tr><td style="text-align:left;">heap_memory_init</td> <td style="text-align:left;">heap memory initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">heap_memory_max</td> <td style="text-align:left;">Maximum heap memory</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">heap_memory_used</td> <td style="text-align:left;">Heap memory used</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">heap_memory_committed</td> <td style="text-align:left;">The heap memory has been committed</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">non_heap_memory_init</td> <td style="text-align:left;">Non-heap memory initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">non_heap_memory_max</td> <td style="text-align:left;">Maximum non-heap memory</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">non_heap_memory_used</td> <td style="text-align:left;">Non-heap memory used value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">non_heap_memory_committed</td> <td style="text-align:left;">Non-heap memory committed</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">code_cache_init</td> <td style="text-align:left;">Code cache initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">code_cache_max</td> <td style="text-align:left;">Maximum code cache size</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">code_cache_used</td> <td style="text-align:left;">The code cache has been used</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">code_cache_committed</td> <td style="text-align:left;">The code cache has been committed</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">meta_sapce_init</td> <td style="text-align:left;">Metaspace initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">meta_sapce_max</td> <td style="text-align:left;">Maximum value of metaspace</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">meta_sapce_used</td> <td style="text-align:left;">Metaspace used value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">meta_sapce_committed</td> <td style="text-align:left;">Metaspace committed value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">compressed_class_space_init</td> <td style="text-align:left;">Compressed class space initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">compressed_class_space_max</td> <td style="text-align:left;">Maximum compressed class space</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">compressed_class_space_used</td> <td style="text-align:left;">Compressed class space used value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">compressed_class_space_committed</td> <td style="text-align:left;">Compressed class space committed value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">eden_init</td> <td style="text-align:left;">eden memory initialization value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">eden_max</td> <td style="text-align:left;">maximum memory of eden area</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">eden_used</td> <td style="text-align:left;">used value of eden area memory</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">eden_committed</td> <td style="text-align:left;">eden area memory committed value</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">survivor_init</td> <td style="text-align:left;">memory initialization value of the survivor area</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">survivor_max</td> <td style="text-align:left;">maximum memory of the survivor area</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">survivor_used</td> <td style="text-align:left;">Memory used value of the survivor area</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">survivor_committed</td> <td style="text-align:left;">memory committed value of the survivor area</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_init</td> <td style="text-align:left;">Memory initialization value in the old era</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_max</td> <td style="text-align:left;">Maximum memory in the old age</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_used</td> <td style="text-align:left;">Memory used in the old age</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_committed</td> <td style="text-align:left;">Memory committed value in the old age</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">thread_live</td> <td style="text-align:left;">Active thread</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">thread_peak</td> <td style="text-align:left;">thread peak</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">thread_daemon</td> <td style="text-align:left;">daemon thread</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">new_gen_count</td> <td style="text-align:left;">Young generation GC times</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">new_gen_spend</td> <td style="text-align:left;">Young generation GC time</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_count</td> <td style="text-align:left;">GC times of older generation</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">old_gen_spend</td> <td style="text-align:left;">GC time of the elderly generation</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">cpu_used</td> <td style="text-align:left;">CPU usage of JVM</td> <td style="text-align:left;">JVM</td></tr> <tr><td style="text-align:left;">start_time</td> <td style="text-align:left;">JVM started time, milliseconds</td> <td style="text-align:left;">JVM</td></tr></tbody></table> <h3 id="data-request-metrics"><a href="#data-request-metrics" class="header-anchor">#</a> Data Request Metrics</h3> <table><thead><tr><th style="text-align:left;">Indicator name</th> <th style="text-align:left;">Description</th> <th style="text-align:left;">Indicator type</th></tr></thead> <tbody><tr><td style="text-align:left;">qps</td> <td style="text-align:left;">Requests per second</td> <td style="text-align:left;">Throughput</td></tr> <tr><td style="text-align:left;">tps</td> <td style="text-align:left;">Number of requests processed per second</td> <td style="text-align:left;">Throughput</td></tr> <tr><td style="text-align:left;">avg_response_time</td> <td style="text-align:left;">Average response time</td> <td style="text-align:left;">Throughput</td></tr></tbody></table> <h3 id="circuit-breaker-indicator"><a href="#circuit-breaker-indicator" class="header-anchor">#</a> Circuit breaker indicator</h3> <table><thead><tr><th style="text-align:left;">Indicator Name</th> <th style="text-align:left;">Description</th> <th style="text-align:left;">Indicator Type</th></tr></thead> <tbody><tr><td style="text-align:left;">fused_request</td> <td style="text-align:left;">Number of fused requests (number of requests triggering fused matching rules)</td> <td style="text-align:left;">Fused</td></tr> <tr><td style="text-align:left;">failure_fuse_request</td> <td style="text-align:left;">Number of failed requests (number of requests that failed and ignored exceptions)</td> <td style="text-align:left;">Breach</td></tr> <tr><td style="text-align:left;">failure_rate_fuse_request Request</td> <td style="text-align:left;">failure rate</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">avg_response_time</td> <td style="text-align:left;">average response time</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">qps</td> <td style="text-align:left;">Requests per second</td> <td style="text-align:left;">Blowdown</td></tr> <tr><td style="text-align:left;">tps</td> <td style="text-align:left;">number of transactions processed per second</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">slow_call_number</td> <td style="text-align:left;">number of slow calls</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">permitted_fuse_request</td> <td style="text-align:left;">number of allowed calls</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">buffered_calls_number</td> <td style="text-align:left;">number of cache calls</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">slow_call_failure_number</td> <td style="text-align:left;">number of slow call failures</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">successful_calls_number</td> <td style="text-align:left;">number of successful calls</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">not_permitted_calls_number</td> <td style="text-align:left;">number of calls not allowed</td> <td style="text-align:left;">circuit breaker</td></tr> <tr><td style="text-align:left;">slow_call_success_number</td> <td style="text-align:left;">number of successful slow calls</td> <td style="text-align:left;">circuit breaker</td></tr></tbody></table> <h2 id="supported-versions-and-restrictions"><a href="#supported-versions-and-restrictions" class="header-anchor">#</a> Supported versions and restrictions</h2> <p>Framework support:</p> <ul><li><p>SpringBoot 1.5.10. Release and above</p></li> <li><p>Dubbo 2.6.x-2.7.x</p></li></ul> <p>Restrictions:</p> <ul><li><p>Dependent on Prometheus</p></li> <li><p>The collection of server indicators depends on the Linux environment</p></li></ul> <h2 id="operation-and-result-verification"><a href="#operation-and-result-verification" class="header-anchor">#</a> Operation and result verification</h2> <p>The following will demonstrate how to use the monitoring plug-in.</p> <h3 id="preparations"><a href="#preparations" class="header-anchor">#</a> Preparations</h3> <ul><li><p><a href="https://start.spring.io/#!type=maven-project&amp;language=java&amp;platformVersion=2.7.7&amp;packaging=jar&amp;jvmVersion=1.8&amp;groupId=com.example&amp;artifactId=demo&amp;name=demo&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.demo&amp;dependencies=web" target="_blank" rel="noopener noreferrer">Download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> demo application</p></li> <li><p><a href="https://github.com/sermant-io/Sermant/releases" target="_blank" rel="noopener noreferrer">Download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>/Compile the sermant package</p></li> <li><p><a href="https://github.com/prometheus/prometheus/releases" target="_blank" rel="noopener noreferrer">Download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Prometheus</p></li></ul> <blockquote><p>Note: <a href="/en/document/user-guide/configuration-center.html">Dynamic Configuration Center</a> will be used by default in this scenario. Since it is not the core component of this scenario, it will not be described in this article.</p></blockquote> <h3 id="step-1-compile-and-package-the-demo-application"><a href="#step-1-compile-and-package-the-demo-application" class="header-anchor">#</a> Step 1: Compile and package the demo application</h3> <p>Execute the following command in the root directory of the demo application to package the demo application:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>mvn clean package
</code></pre></div><p>After the packaging is successful, a <code>target</code> folder will be generated in the demo root directory, enter the <code>target</code> folder to get the demo-0.0.1-SNAPSHOT.jar package.</p> <h3 id="step-2-modify-the-configuration"><a href="#step-2-modify-the-configuration" class="header-anchor">#</a> Step 2: Modify the configuration</h3> <ul><li>Modify the monitoring plug-in configuration, which can be found in the <code>${path}/sermant-agent-x.x.x/agent/pluginPackage/monitor/config/config.yaml</code>.</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">monitor.config</span><span class="token punctuation">:</span>                   <span class="token comment"># Monitoring plugin configuration</span>
    <span class="token key atrule">enableStartService</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>      <span class="token comment"># Monitoring plugin start switch. Modify to true.</span>
    <span class="token key atrule">address</span><span class="token punctuation">:</span> 127.0.0.1            <span class="token comment"># IP address/domain name of the host application's environment. Modify to host specific IP address.</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">12345</span>                   <span class="token comment"># Provides the port information of Http service externally. Modify to an available port.</span>
    <span class="token key atrule">reportType</span><span class="token punctuation">:</span> PROMETHEUS        <span class="token comment"># Monitoring indicator reporting method. Currently only PROMETHEUS is supported.</span>
</code></pre></div><ul><li>Modify the configuration file prometheus.yml of <a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noopener noreferrer">Prometheus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <p>Add job information under the original job information.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scrape_ configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_Name</span><span class="token punctuation">:</span> <span class="token string">&quot;prometheus&quot;</span>            <span class="token comment"># Job name. This is the original task of prometheus.</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;localhost:9090&quot;</span><span class="token punctuation">]</span>   <span class="token comment"># Monitoring host address</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_Name</span><span class="token punctuation">:</span> <span class="token string">&quot;Sermant&quot;</span>               <span class="token comment"># Job name. Add the job of collecting and monitoring plug-in indicators</span>
    <span class="token key atrule">metrics_path</span><span class="token punctuation">:</span> /                   <span class="token comment"># The request path for collecting indicators. Default is/</span>
    <span class="token key atrule">basic_auth</span><span class="token punctuation">:</span>                       <span class="token comment"># Collect the authorization information of indicators, which is consistent with the monitoring plug-in configuration. The monitoring plug-in can be deleted when it is not configured.</span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span>                       <span class="token comment"># Collect the authorization information of the indicator - username</span>
      <span class="token key atrule">password</span><span class="token punctuation">:</span>                       <span class="token comment"># Collect the authorization information of the indicator - password</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>                   
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1:12345&quot;</span><span class="token punctuation">]</span>  <span class="token comment"># The host address of the collection index. The IP and port information here is consistent with the monitoring plug-in configuration</span>
</code></pre></div><h3 id="step-3-start-the-application"><a href="#step-3-start-the-application" class="header-anchor">#</a> Step 3: Start the application</h3> <ul><li>Start the demo application with the following command</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># Run under Linux</span>
<span class="token function">java</span> -javaagent:<span class="token variable">${path}</span>/sermant-agent-x.x.x/agent/sermant-agent.jar<span class="token operator">=</span>appName<span class="token operator">=</span>default <span class="token parameter variable">-jar</span> demo-0.0.1-SNAPSHOT.jar
</code></pre></div><div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># Run under Windows</span>
<span class="token function">java</span> -javaagent:<span class="token variable">${path}</span><span class="token punctuation">\</span>sermant-agent-x.x.x<span class="token punctuation">\</span>agent<span class="token punctuation">\</span>sermant-agent.jar<span class="token operator">=</span>appName<span class="token operator">=</span>default <span class="token parameter variable">-jar</span> demo-0.0.1-SNAPSHOT.jar
</code></pre></div><blockquote><p><strong>illustrate</strong>:
Where path needs to be replaced with the actual installation path of Sermant.
x.x.x represents a Sermant version number.</p></blockquote> <ul><li>Start Prometheus</li></ul> <h3 id="verification"><a href="#verification" class="header-anchor">#</a> Verification</h3> <p>Open Prometheus (default is <code>http://127.0.0.1:9090</code>), query indicators. For example, query <code>heap_memory_used</code>. If the information can be queried, the plug-in will become effective.</p> <p>The query effect is as follows:</p> <div class="el-image"><div class="el-image__placeholder"></div><!----></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/14/2024, 8:32:18 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/document/plugin/router.html" class="prev">
        Tag Router
      </a></span> <span class="next"><a href="/en/document/plugin/visibility.html">
        Service visibility
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e0934d96.js" defer></script><script src="/assets/js/3.06f127bc.js" defer></script><script src="/assets/js/1.c8bacf5b.js" defer></script><script src="/assets/js/53.9cfa5608.js" defer></script><script src="/assets/js/14.199c38f6.js" defer></script>
  </body>
</html>
