(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{544:function(t,e,a){"use strict";a.r(e);var n=a(26),s=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"sermant-agent使用手册"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent使用手册"}},[t._v("#")]),t._v(" Sermant-agent使用手册")]),t._v(" "),e("p",[t._v("sermant-agent为Sermant必要核心组件，包含"),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-agentcore",target:"_blank",rel:"noopener noreferrer"}},[t._v("sermant-agentcore"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("sermant-plugins"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-common",target:"_blank",rel:"noopener noreferrer"}},[t._v("sermant-common"),e("OutboundLink")],1),t._v("等字节码增强逻辑的实现主体。"),e("RouterLink",{attrs:{to:"/zh/document/user-guide/"}},[t._v("Sermant使用介绍")]),t._v("中描述的产品目录"),e("code",[t._v("sermant-agent-x.x.x/agent")]),t._v("目录下内容即为sermant-agent组件的各模块。本文介绍如何使用sermant-agent。")],1),t._v(" "),e("p",[t._v("sermant-agent的框架主体为Sermant提供了字节码增强的实现逻辑，同时支持心跳功能、动态配置功能、日志功能、事件上报等公共核心能力。sermant-agent插件包中则由各扩展插件提供了标签路由、限流降级、双注册等服务治理能力。")]),t._v(" "),e("h2",{attrs:{id:"参数配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数配置"}},[t._v("#")]),t._v(" 参数配置")]),t._v(" "),e("p",[t._v("在Java程序启动时，通过 "),e("code",[t._v("-javaagent")]),t._v("参数指定"),e("code",[t._v("sermant-agent.jar")]),t._v("的文件路径，即可使该Java程序(也称为宿主应用)在运行时挂载sermant-agent。"),e("code",[t._v("sermant-agent.jar")]),t._v("在Sermant打包后产品包的"),e("code",[t._v("agent/sermant-agent.jar")]),t._v("路径中存放。")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("-javaagent:sermant-agent.jar"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${options}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("p",[t._v("其中"),e("code",[t._v("${options}")]),t._v("为启动参数，会作为"),e("code",[t._v("premain")]),t._v("方法的入参"),e("code",[t._v("agentArgs")]),t._v("传入。")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("premain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" agentArgs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Instrumentation")]),t._v(" inst"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("参数"),e("code",[t._v("agentArgs")]),t._v("的格式要求形如"),e("code",[t._v("key1=value1,key2=value2[(,keyN=valueN)...]")]),t._v("，以"),e("code",[t._v("','")]),t._v("分割键值对，以"),e("code",[t._v("'='")]),t._v("分割键值，形成"),e("code",[t._v("Map")]),t._v("结构。")]),t._v(" "),e("h3",{attrs:{id:"sermant-agent启动参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent启动参数"}},[t._v("#")]),t._v(" Sermant-agent启动参数")]),t._v(" "),e("p",[e("strong",[t._v("启动参数")]),t._v("配置参考如下：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数键")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("默认值")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("是否必须")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("appName")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("应用名称，可用于实例心跳发送等")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("default")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("serviceName")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("微服务名称，可用于实例心跳发送等")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("default")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("应用：完成某项完整业务场景的软件系统。应用一般由多个微服务组成，应用里面的微服务能够相互发现和调用。")]),t._v(" "),e("p",[t._v("微服务：微服务是业务概念，即提供某种服务的某个进程。每一个服务都具有自主运行的业务功能，对外开放不受语言限制的API (最常用的是HTTP)。")])]),t._v(" "),e("p",[t._v("入参"),e("code",[t._v("agentArgs")]),t._v("中也可以为"),e("strong",[t._v("启动参数")]),t._v("配置自定义的值。")]),t._v(" "),e("p",[t._v("此外，启动参数也可在sermant-agent的产品包下"),e("code",[t._v("agent/config/bootstrap.properties")]),t._v("中配置，配置参考与上述一致，同时也支持增加自定义启动参数。")]),t._v(" "),e("h3",{attrs:{id:"sermant-agent使用参数配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent使用参数配置"}},[t._v("#")]),t._v(" Sermant-agent使用参数配置")]),t._v(" "),e("p",[t._v("Sermant除插件配置外的其他配置都在sermant-agent的产品包下"),e("code",[t._v("agent/config/config.properties")]),t._v("中配置。各插件的参数配置请参考"),e("a",{attrs:{href:"https://sermant.io/zh/document/plugin/",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件使用手册"),e("OutboundLink")],1),t._v("中相关描述。")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# agent config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.isEnhanceBootStrapEnable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.ignoredPrefixes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("com.huawei.sermant,com.huaweicloud.sermant")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.ignoredInterfaces")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("org.springframework.cglib.proxy.Factory")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.combineStrategy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("ALL")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.serviceInjectList")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("com.huawei.discovery.service.lb.filter.NopInstanceFilter,com.huawei.discovery.service.lb.DiscoveryManager,com.huawei.discovery.service.util.ApplyUtil,com.huawei.discovery.service.lb.cache.InstanceCacheManager")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.isOutputEnhancedClasses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.enhancedClassesOutputPath")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.config.isShowEnhanceLog")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# agent service config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.heartbeat.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.gateway.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.tracing.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.visibility.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.inject.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.monitor.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("agent.service.dynamic.config.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# event config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("event.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("event.offerWarnLog")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("event.offerErrorLog")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("event.sendInterval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("30000")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("event.offerInterval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("300000")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dynamic config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.timeoutValue")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("30000")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.defaultGroup")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("sermant")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.serverAddress")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1:2181")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.dynamicConfigType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("ZOOKEEPER")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.connectRetryTimes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.connectTimeout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1000")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.userName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.privateKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dynamic.config.enableAuth")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# heartbeat config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("heartbeat.interval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("30000")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gateway config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyIp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("127.0.0.1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("6888")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyConnectTimeout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5000")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.nettyWriteAndReadWaitTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("60000")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.sendInternalTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.initReconnectInternalTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("gateway.maxReconnectInternalTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("180")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# service meta config")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service.meta.application")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("default")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service.meta.version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1.0.0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service.meta.project")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("default")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service.meta.environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service.meta.zone")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n")])])]),e("p",[t._v("其中涉及的参数与sermant-agent、Backend、动态配置中心等有关联，具体参数配置参考下面说明。")]),t._v(" "),e("h4",{attrs:{id:"字节码增强参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#字节码增强参数"}},[t._v("#")]),t._v(" 字节码增强参数")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("span",{staticStyle:{display:"inline-block",width:"100px"}},[t._v("参数键")])]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[e("span",{staticStyle:{display:"inline-block",width:"200px"}},[t._v("说明")])]),t._v(" "),e("th",[e("span",{staticStyle:{display:"inline-block",width:"70px"}},[t._v("参数类别")])]),t._v(" "),e("th",[t._v("默认值")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("是否必须")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("agent.config.isEnhanceBootStrapEnable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用于控制字节码增强的重转换开关，配置为true则可支持重转换")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.ignoredPrefixes")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以集合中元素为前缀的类，不会被字节码增强")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("com.huawei.sermant,com.huaweicloud.sermant")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.ignoredInterfaces")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("该集合中定义的接口实现，不会被字节码增强")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("org.springframework.cglib.proxy.Factory")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.combineStrategy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("插件声明器的合并策略：NONE，不合并；BY_NAME，通过匹配的类名合并；ALL，所有都合并")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("ALL")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.serviceInjectList")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("指定插件服务中允许被字节码增强的类（插件服务中的类默认不允许被字节码增强）")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("com.huawei.discovery.service.lb.filter.NopInstanceFilter"),e("br"),t._v(",com.huawei.discovery.service.lb.DiscoveryManager")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.isShowEnhanceLogEnable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用于控制Byte-Buddy日志输出的开关")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.enhancedClassOutputPath")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("指定被增强类的字节码的输出路径")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.config.isOutputEnhancedClasses")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用于控制被增强的类的字节码文件输出的开关")]),t._v(" "),e("td",[t._v("agent参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"核心服务开关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#核心服务开关"}},[t._v("#")]),t._v(" 核心服务开关")]),t._v(" "),e("p",[t._v("下述配置用于控制框架提供的各核心服务的开启和关闭：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("参数键")])]),t._v(" "),e("th",[e("strong",[t._v("说明")])]),t._v(" "),e("th",[e("strong",[t._v("参数类别")])]),t._v(" "),e("th",[e("strong",[t._v("默认值")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("是否必须")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("agent.service.heartbeat.enable")]),t._v(" "),e("td",[t._v("心跳服务开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.gateway.enable")]),t._v(" "),e("td",[t._v("网关服务开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.tracing.enable")]),t._v(" "),e("td",[t._v("链路服务开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.visibility.enable")]),t._v(" "),e("td",[t._v("服务可见性开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.inject.enable")]),t._v(" "),e("td",[t._v("spring类注入开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("true")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.monitor.enable")]),t._v(" "),e("td",[t._v("监控开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("agent.service.dynamic.config.enable")]),t._v(" "),e("td",[t._v("动态配置服务开关")]),t._v(" "),e("td",[t._v("核心服务参数")]),t._v(" "),e("td",[t._v("true")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"事件上报参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事件上报参数"}},[t._v("#")]),t._v(" 事件上报参数")]),t._v(" "),e("p",[t._v("下述配置用于控制框架提供的事件系统：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("参数键")])]),t._v(" "),e("th",[e("strong",[t._v("说明")])]),t._v(" "),e("th",[e("strong",[t._v("参数类别")])]),t._v(" "),e("th",[e("strong",[t._v("默认值")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("是否必须")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("event.enable")]),t._v(" "),e("td",[t._v("事件控制开关，开启后事件将会上报至"),e("RouterLink",{attrs:{to:"/zh/document/user-guide/backend.html"}},[t._v("Backend")])],1),t._v(" "),e("td",[t._v("事件上报参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("event.offerWarnLog")]),t._v(" "),e("td",[t._v("上报Warn日志开关")]),t._v(" "),e("td",[t._v("事件上报参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("event.offerErrorLog")]),t._v(" "),e("td",[t._v("上报Error日志开关")]),t._v(" "),e("td",[t._v("事件上报参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("event.sendInterval")]),t._v(" "),e("td",[t._v("事件发送时间间隔(ms)")]),t._v(" "),e("td",[t._v("事件上报参数")]),t._v(" "),e("td",[t._v("30000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("event.offerInterval")]),t._v(" "),e("td",[t._v("事件记录时间间隔(ms),在一定时间内重复事件压缩")]),t._v(" "),e("td",[t._v("事件上报参数")]),t._v(" "),e("td",[t._v("300000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"动态配置中心参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#动态配置中心参数"}},[t._v("#")]),t._v(" 动态配置中心参数")]),t._v(" "),e("p",[t._v("下述配置为控制与动态配置中心连接时的可自定义属性：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[e("span",{staticStyle:{display:"inline-block",width:"100px"}},[t._v("参数键")])]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[e("span",{staticStyle:{display:"inline-block",width:"200px"}},[t._v("说明")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("参数类别")]),t._v(" "),e("th",[t._v("默认值")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("是否必须")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.timeoutValue")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("配置中心服务器连接超时时间，单位：ms")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("30000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.defaultGroup")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置默认分组")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("sermant")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.serverAddress")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("配置中心服务器地址，必须形如：{@code host:port[(,host:port)...]}")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("127.0.0.1:2181")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.dynamicConfigType")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心服务实现类型，当前支持Zookeeper和Kie。取值范围为NOP(无实现)、ZOOKEEPER或KIE。")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("ZOOKEEPER")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.connectRetryTimes")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：启动Sermant时的配置中心的重连次数")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("5")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.connectTimeout")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：启动Sermant时连接配置中心的时间时间")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("1000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.userName")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：配置中心的用户名")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.password")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：配置中心的加密后的密码")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.privateKey")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：用于对密码加解密的密钥")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("dynamic.config.enableAuth")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("动态配置中心ZOOKEEPER：是否开启配置中心授权，开启后需验证用户名密码")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("动态配置中心参数")]),t._v(" "),e("td",[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"心跳服务参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#心跳服务参数"}},[t._v("#")]),t._v(" 心跳服务参数")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("参数键")])]),t._v(" "),e("th",[e("strong",[t._v("说明")])]),t._v(" "),e("th",[e("strong",[t._v("参数类别")])]),t._v(" "),e("th",[e("strong",[t._v("默认值")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("是否必须")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("heartbeat.interval")]),t._v(" "),e("td",[t._v("心跳发送间隔，单位：ms")]),t._v(" "),e("td",[t._v("Heartbeat参数")]),t._v(" "),e("td",[t._v("30000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"网关服务参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网关服务参数"}},[t._v("#")]),t._v(" 网关服务参数")]),t._v(" "),e("p",[t._v("下述配置用于控制在通过网关服务和Backend交互时的可自定义属性：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("参数键")])]),t._v(" "),e("th",[e("strong",[t._v("说明")])]),t._v(" "),e("th",[e("strong",[t._v("参数类别")])]),t._v(" "),e("th",[e("strong",[t._v("默认值")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("是否必须")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("gateway.nettyIp")]),t._v(" "),e("td",[t._v("Gateway消息接收地址")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("127.0.0.1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.nettyPort")]),t._v(" "),e("td",[t._v("Gateway消息接收端口")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("6888")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.nettyConnectTimeout")]),t._v(" "),e("td",[t._v("Gateway连接超时时间")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("5000（ms）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.nettyWriteAndReadWaitTime")]),t._v(" "),e("td",[t._v("Gateway读/写超时时间")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("60000（ms）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.sendInternalTime=10")]),t._v(" "),e("td",[t._v("Gateway消息发送时间间隔")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("10（s）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.initReconnectInternalTime=5")]),t._v(" "),e("td",[t._v("Gateway重连退避算法初始连接间隔")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("5（s）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",[t._v("gateway.maxReconnectInternalTime=180")]),t._v(" "),e("td",[t._v("Gateway重连退避算法最大连接间隔")]),t._v(" "),e("td",[t._v("Gateway参数")]),t._v(" "),e("td",[t._v("180（s）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h4",{attrs:{id:"服务元数据参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务元数据参数"}},[t._v("#")]),t._v(" 服务元数据参数")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[e("span",{staticStyle:{display:"inline-block",width:"100px"}},[t._v("参数键")])]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[e("span",{staticStyle:{display:"inline-block",width:"200px"}},[t._v("说明")])]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("参数类别")]),t._v(" "),e("th",[t._v("默认值")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("是否必须")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.application")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("应用名称，用于服务注册等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("default")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.version")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("服务版本，用于服务注册、标签路由等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("1.0.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.project")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("服务命名空间，用于服务注册等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("default")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.environment")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("服务所在环境，用于服务注册等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.zone")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("服务所在az，用于服务注册、标签路由等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("service.meta.parameters")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("服务额外参数信息，以key:value形式配置，逗号分隔多个键值对，用于服务注册、标签路由等服务治理场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("服务元数据参数")]),t._v(" "),e("td",[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("h3",{attrs:{id:"sermant-agent挂载插件配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent挂载插件配置"}},[t._v("#")]),t._v(" Sermant-agent挂载插件配置")]),t._v(" "),e("p",[t._v("Sermant自定义选择挂载哪些插件可在sermant-agent的产品包下"),e("code",[t._v("agent/config/plugins.yaml")]),t._v("中配置，配置方式如下：")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("plugins")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                 "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可自定义配置默认挂载的插件名称")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" flowcontrol\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("router\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("registry\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" loadbalancer\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" dynamic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" monitor\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" springboot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("registry\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mq"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("consume"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deny\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("removal\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("visibility\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("profiles")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# profiles自定义不同场景需配置挂载的插件列表")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cse")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" flowcontrol\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("router\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("registry\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" dynamic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apm")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" flowcontrol\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("router\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("profile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cse"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("apm         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# profile用于按场景配置挂载的插件列表，此处配置生效的场景")]),t._v("\n\n")])])]),e("p",[t._v("其中各参数配置说明如下：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数键")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("是否必须")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("plugins")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("以列表形式配置默认需加载的插件")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("profiles")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("自定义配置各个场景下需挂载的插件列表")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("profile")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("自定义配置需加载的场景名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),e("p",[t._v("启动时，"),e("code",[t._v("plugins")]),t._v(" 下配置的插件都会挂载至宿主应用，"),e("code",[t._v("profile")]),t._v("下的插件列表也可按需配置生效。")]),t._v(" "),e("p",[e("strong",[t._v("插件的加载顺序")])]),t._v(" "),e("p",[t._v("Sermant插件的加载顺序如下：")]),t._v(" "),e("ol",[e("li",[t._v("首先按照"),e("code",[t._v("plugins")]),t._v("中配置的插件顺序来加载默认插件。")]),t._v(" "),e("li",[t._v("然后再按照"),e("code",[t._v("profile")]),t._v("配置的场景顺序来加载场景插件列表，各场景的插件加载顺序也和配置文件中的顺序一致。")]),t._v(" "),e("li",[t._v("如果"),e("code",[t._v("profiles")]),t._v("中的配置的插件已经在之前加载过，则不再重复加载。")]),t._v(" "),e("li",[t._v("不同插件的相同拦截点的字节码增强的"),e("strong",[t._v("生效顺序与插件加载顺序")]),t._v("是一致的。")])]),t._v(" "),e("h3",{attrs:{id:"参数配置方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数配置方式"}},[t._v("#")]),t._v(" 参数配置方式")]),t._v(" "),e("p",[t._v("Sermant项目sermant-agent的properties配置文件和各插件的中yaml配置文件都支持下列几种参数配置方式，以配置文件中的"),e("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v("为例：")]),t._v(" "),e("ol",[e("li",[t._v("直接修改配置文件，即在配置文件中修改"),e("code",[t._v("gateway.nettyIp=127.0.0.1")])]),t._v(" "),e("li",[t._v("通过应用启动时的-D参数配置，即"),e("code",[t._v("-Dgateway.nettyIp=127.0.0.1")])]),t._v(" "),e("li",[t._v("通过环境变量配置，即在环境变量中新增"),e("code",[t._v("gateway.nettyIp=127.0.0.1")])]),t._v(" "),e("li",[t._v("通过sermant-agent启动参数配置，即"),e("code",[t._v("-javaagent:sermant-agent.jar=gateway.nettyIp=127.0.0.1")])])]),t._v(" "),e("p",[t._v("以上四种方式，配置生效的优先级从高到低排列为：4 > 3 > 2 > 1。")]),t._v(" "),e("p",[t._v("其中，后三种参数配置值的获取方式支持多种格式，以配置文件中的"),e("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v("为例，下列配置格式都可识别：")]),t._v(" "),e("div",{staticClass:"language-txt extra-class"},[e("pre",{pre:!0,attrs:{class:"language-txt"}},[e("code",[t._v("gateway.nettyIp=127.0.0.1\ngateway_nettyIp=127.0.0.1\ngateway-nettyIp=127.0.0.1\nGATEWAY.NETTYIP=127.0.0.1\nGATEWAY_NETTYIP=127.0.0.1\nGATEWAY-NETTYIP=127.0.0.1\ngateway.nettyip=127.0.0.1\ngateway_nettyip=127.0.0.1\ngateway-nettyip=127.0.0.1\ngateway.netty.ip=127.0.0.1\ngateway_netty_ip=127.0.0.1\ngateway-netty-ip=127.0.0.1\nGATEWAY.NETTY.IP=127.0.0.1\nGATEWAY_NETTY_IP=127.0.0.1\nGATEWAY-NETTY-IP=127.0.0.1\n")])])]),e("p",[t._v("sermant-agent将从上至下依次检索各项配置值是否通过启动参数、环境变量、-D参数来配置。")]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("注意：")]),t._v(" 通过容器场景的env修改配置，请将点（.）可用下划线（_）替代！！！")]),t._v(" "),e("p",[t._v("原因：因为一些OS镜像无法识别带 . 的env")])]),t._v(" "),e("p",[t._v("举个例子：如需想通过pod的env修改配置文件中的"),e("code",[t._v("gateway.nettyIp=127.0.0.1")]),t._v("则")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway_nettyIp"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.2"')]),t._v("\n")])])]),e("h2",{attrs:{id:"支持版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#支持版本"}},[t._v("#")]),t._v(" 支持版本")]),t._v(" "),e("h3",{attrs:{id:"sermant-agent-支持的版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sermant-agent-支持的版本"}},[t._v("#")]),t._v(" sermant-agent 支持的版本")]),t._v(" "),e("p",[t._v("sermant-agent支持Linux、Windows，基于JDK 1.8开发，建议使用JDK 1.8版本及以上版本。")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://gitee.com/openeuler/bishengjdk-8",target:"_blank",rel:"noopener noreferrer"}},[t._v("HuaweiJDK 1.8"),e("OutboundLink")],1),t._v(" / "),e("a",{attrs:{href:"https://github.com/openjdk/jdk",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenJDK 1.8"),e("OutboundLink")],1),t._v(" / "),e("a",{attrs:{href:"https://www.oracle.com/java/technologies/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OracleJDK 1.8"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"启动和结果验证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动和结果验证"}},[t._v("#")]),t._v(" 启动和结果验证")]),t._v(" "),e("h3",{attrs:{id:"启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),e("p",[t._v("以"),e("strong",[t._v("Sermant-example")]),t._v("项目 "),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant-examples/tree/main/sermant-template/demo-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("demo-application"),e("OutboundLink")],1),t._v("为宿主应用，执行以下命令挂载sermant-agent启动demo-application:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run under Windows")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:sermant-agent-x.x.x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sermant-agent.jar"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("appName"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" demo-application.jar\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run under Linux")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:sermant-agent-x.x.x/agent/sermant-agent.jar"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("appName"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" demo-application.jar\n")])])]),e("h3",{attrs:{id:"验证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[t._v("#")]),t._v(" 验证")]),t._v(" "),e("p",[t._v("查看demo-application的日志文件开头是否包含以下内容：")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading core library"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building argument map"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Loading sermant agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Load sermant done. \n")])])]),e("p",[t._v("若日志如上正常输出，则说明sermant-agent挂载成功。")])])}),[],!1,null,null,null);e.default=s.exports}}]);