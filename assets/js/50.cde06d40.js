(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{496:function(t,e,a){"use strict";a.r(e);var n=a(26),s=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"outlier-instance-removal"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#outlier-instance-removal"}},[t._v("#")]),t._v(" Outlier instance removal")]),t._v(" "),e("p",[t._v("This article introduces how to use the "),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-plugins/sermant-service-removal",target:"_blank",rel:"noopener noreferrer"}},[t._v("Outlier instance removal plugin"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"function-introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#function-introduction"}},[t._v("#")]),t._v(" Function Introduction")]),t._v(" "),e("p",[t._v("The outlier instance removal plugin detects the availability of application instances in a non-invasive manner, and performs removal operations on abnormal application instances to ensure service stability. The outlier instance removal plugin will retest the availability of the removed instance after a period of time. If the instance returns to normal, it will not be removed again.")]),t._v(" "),e("h2",{attrs:{id:"parameter-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#parameter-configuration"}},[t._v("#")]),t._v(" Parameter configuration")]),t._v(" "),e("h3",{attrs:{id:"plugin-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugin-configuration"}},[t._v("#")]),t._v(" Plugin Configuration")]),t._v(" "),e("p",[t._v("The outlier instance removal plugin requires configuration of the outlier instance removal plugin switch ("),e("code",[t._v("remove.config.enableRemoval")]),t._v("), instance call information expiration time ("),e("code",[t._v("remove.config.expireTime")]),t._v("), service call exceptions supported by the plugin ("),e("code",[t._v("remove.config.exceptions")]),t._v("), recovery time after instance removal ("),e("code",[t._v("remove.config.recoveryTime")]),t._v("), and outlier instance removal rules ("),e("code",[t._v("remove.config.rules")]),t._v("), The configuration file for the plugin can be found in "),e("code",[t._v("${path}/sermant-agent-x.x.x/agent/pluginPackage/service-removal/config/config.yaml")]),t._v(", as shown below:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal plugin configuration")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("removal.config")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expireTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The expiration time of instance call information. Unit: milliseconds")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("exceptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("               "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Service invocation exceptions supported by plugins")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" com.alibaba.dubbo.remoting.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" org.apache.dubbo.remoting.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.util.concurrent.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.net.SocketTimeoutException\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enableRemoval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal switch")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("recoveryTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Recovery time after instance removal")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal rules, key: Service name (default rule applies to all services), scaleUpLimit: The upper limit of the outlier instance removal ratio. MinInstanceNum: The minimum number of instances.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scaleUpLimit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("minInstanceNum")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("errorRate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Parameter key")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Description")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Default value")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Is it required")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("removal.config.expireTime")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Instance call information expiration time")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("60000")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("removal.config.exceptions")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Service call exceptions supported by plugins")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("com. alibaba. dubbo. remoting. TimeoutException"),e("br"),t._v("org. apache. dubo. remoting. TimeoutException"),e("br"),t._v("java. util. concurrent. TimeoutException"),e("br"),t._v("java. net. SocketTimeoutException")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("removal.config.enableRemoval")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Switch for instance removal plugins")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("false")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("removal.config.recoveryTime")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Recovery time after instance removal")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("30000")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("removal.config.rules")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Outlier instance removal rules:"),e("br"),t._v("key: service name (valid for all services when default rule is set)"),e("br"),t._v("scaleUpLimit: upper limit of outlier instance removal ratio"),e("br"),t._v("minInstanceNum: minimum number of instances")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("{key: default rule, scaleUpLimit: 0.6, minInstanceNum: 1, errorRate: 0.6}")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])])])]),t._v(" "),e("h2",{attrs:{id:"detailed-removal-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#detailed-removal-rules"}},[t._v("#")]),t._v(" Detailed removal rules")]),t._v(" "),e("p",[t._v("The outlier instance extraction plugin also supports configuration publishing based on the dynamic configuration center. For configuration publishing, please refer to the "),e("RouterLink",{attrs:{to:"/en/document/user-guide/configuration-center.html#publish-configuration"}},[t._v("Dynamic Configuration Center User Manual")]),t._v(".")],1),t._v(" "),e("p",[t._v("The key value is "),e("strong",[t._v("servant.remove.config")]),t._v(". The group value is "),e("strong",[t._v("app=${service.meta.application}&environment=${service.meta.environment}")]),t._v(", which is the application configuration. For the configuration of service.meta.application and service.meta.environment, please refer to the "),e("RouterLink",{attrs:{to:"/en/document/user-guide/sermant-agent.html#sermant-agent-parameter-configuration"}},[t._v("Service Agent User Manual")]),t._v(".")],1),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("Note:")]),t._v(" Application configuration instructions refer to "),e("a",{attrs:{href:"https://support.huaweicloud.com/devg-cse/cse_devg_0020.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSE Configuration Center Overview"),e("OutboundLink")],1),t._v("。\nThe content value is the specific outlier instance extraction rule configuration. The configuration content is as follows:")])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expireTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The expiration time of instance call information. Unit: milliseconds")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("exceptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("               "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Service invocation exceptions supported by plugins")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" com.alibaba.dubbo.remoting.TimeoutException\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" org.apache.dubbo.remoting.TimeoutException\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.util.concurrent.TimeoutException\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.net.SocketTimeoutException\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enableRemoval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal switch")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("recoveryTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Recovery time after instance removal")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal rules, key: Service name (default rule applies to all services), scaleUpLimit: The upper limit of the outlier instance removal ratio. MinInstanceNum: The minimum number of instances.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scaleUpLimit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("minInstanceNum")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("errorRate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("blockquote",[e("p",[e("strong",[t._v("Note:")]),t._v(" When adding a new configuration, please remove the comments, otherwise it may cause the addition to fail.")])]),t._v(" "),e("h2",{attrs:{id:"supported-versions-and-limitations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#supported-versions-and-limitations"}},[t._v("#")]),t._v(" Supported versions and limitations")]),t._v(" "),e("p",[t._v("Framework support:")]),t._v(" "),e("ul",[e("li",[t._v("SpringBoot 1.5.10. Release and above")]),t._v(" "),e("li",[t._v("Dubbo 2.6.x-2.7.x")])]),t._v(" "),e("h2",{attrs:{id:"operation-and-result-verification"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#operation-and-result-verification"}},[t._v("#")]),t._v(" Operation and result verification")]),t._v(" "),e("p",[t._v("The following will demonstrate how to use the outlier instance extraction plugin to verify the scenario of using the Zookeeper configuration center to configure outlier extraction rules for SpringCloud applications.")]),t._v(" "),e("h3",{attrs:{id:"preparation-work"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#preparation-work"}},[t._v("#")]),t._v(" Preparation work")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant-examples/tree/main/removal-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("Download"),e("OutboundLink")],1),t._v(" Removal-demo source code")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Download"),e("OutboundLink")],1),t._v(" Or compile the Sermant package")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://zookeeper.apache.org/releases#download",target:"_blank",rel:"noopener noreferrer"}},[t._v("Download"),e("OutboundLink")],1),t._v(" And start zookeeper")])]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("Note:")]),t._v(" "),e("RouterLink",{attrs:{to:"/en/document/user-guide/configuration-center.html"}},[t._v("Dynamic Configuration Center")]),t._v(" will be used by default in this scenario. As it is not a core component of this scenario, it will not be further elaborated in this article.")],1)]),t._v(" "),e("h3",{attrs:{id:"step-1-compile-and-package-the-demo-application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-1-compile-and-package-the-demo-application"}},[t._v("#")]),t._v(" Step 1: Compile and package the demo application")]),t._v(" "),e("p",[t._v("Execute the following command in the "),e("code",[t._v("${path}/Sermant-examples/removal-demo")]),t._v(" directory:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows,Linux,mac")]),t._v("\nmvn clean package\n")])])]),e("p",[t._v("After successful packaging:\nGet "),e("code",[t._v("rest-consumer-1.0.0.jar")]),t._v(" in "),e("code",[t._v("${path}/Sermant-examples/removal-demo/rest-consumer/target")]),t._v(".\nGet "),e("code",[t._v("rest-provider-1.0.0.jar")]),t._v(" in "),e("code",[t._v("${path}/Sermant-examples/removal-demo/rest-provider/target")]),t._v(".")]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("Note:")]),t._v(" ${path} is the path where the demo application is downloaded.")])]),t._v(" "),e("h3",{attrs:{id:"step-2-modify-the-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-modify-the-configuration"}},[t._v("#")]),t._v(" Step 2: Modify the configuration")]),t._v(" "),e("ul",[e("li",[t._v("Modify the configuration of the outlier removal plugin, which can be found in "),e("code",[t._v("${path}/sermant-agent-x.x.x/agent/pluginPackage/service-removal/config/config.yaml")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("removal.config")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expireTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The expiration time of instance call information. Unit: milliseconds")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("exceptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("               "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Service invocation exceptions supported by plugins")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" com.alibaba.dubbo.remoting.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" org.apache.dubbo.remoting.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.util.concurrent.TimeoutException\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" java.net.SocketTimeoutException\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enableRemoval")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal switch")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("recoveryTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Recovery time after instance removal")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("                    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Outlier instance removal rules, key: Service name (default rule applies to all services), scaleUpLimit: The upper limit of the outlier instance removal ratio. MinInstanceNum: The minimum number of instances.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scaleUpLimit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("minInstanceNum")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("errorRate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"step-3-start-the-application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-3-start-the-application"}},[t._v("#")]),t._v(" Step 3: Start the application")]),t._v(" "),e("ul",[e("li",[t._v("Start the demo application using the following command\n(1) Launch Consumer")])]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run under Linux")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),t._v("/sermant-agent-x.x.x/agent/sermant-agent.jar"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("appName"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("default "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dniws.loadbalancer.availabilityFilteringRule.filterCircuitTripped")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" rest-consumer-1.0.0.jar\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run under Windows")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" -javaagent:"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${path}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sermant-agent-x.x.x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("sermant-agent.jar"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("appName"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("default "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dniws.loadbalancer.availabilityFilteringRule.filterCircuitTripped")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" rest-consumer-1.0.0.jar\n")])])]),e("p",[t._v("(2) Start Producer")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows,Linux,mac")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" rest-provider-1.0.0.jar\n")])])]),e("p",[t._v("(3) Start the second producer")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows,Linux,mac")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dtimeout")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dserver.port")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8006")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" rest-provider-1.0.0.jar\n")])])]),e("blockquote",[e("p",[e("strong",[t._v("Note:")]),t._v(" ${path} is the actual installation path of the server, and x.x.x represents a certain version number of the server.")])]),t._v(" "),e("h3",{attrs:{id:"verification"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#verification"}},[t._v("#")]),t._v(" Verification")]),t._v(" "),e("p",[t._v("Always access through browser"),e("code",[t._v("http://localhost:8005/hello")]),t._v(" At the beginning, there will be two situations: successful service request and abnormal request. After 30 seconds, the abnormal instance will be removed and the request will continue to be successful. Abnormal instances removed after 30 seconds will recover and request exceptions will reappear.")]),t._v(" "),e("p",[t._v("The query effect is shown below:")]),t._v(" "),e("ul",[e("li",[t._v("Request successful rendering")])]),t._v(" "),e("MyImage",{attrs:{src:"/docs-img/removal-req-success.png"}}),t._v(" "),e("ul",[e("li",[t._v("Request failure rendering")])]),t._v(" "),e("MyImage",{attrs:{src:"/docs-img/removal-req-fail.png"}})],1)}),[],!1,null,null,null);e.default=s.exports}}]);